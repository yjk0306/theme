{"remainingRequest":"/Users/yangjikai/Documents/GitHub/theme/node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!/Users/yangjikai/Documents/GitHub/theme/node_modules/_eslint-loader@2.2.1@eslint-loader/index.js??ref--13-0!/Users/yangjikai/Documents/GitHub/theme/src/plugin/index.js","dependencies":[{"path":"/Users/yangjikai/Documents/GitHub/theme/src/plugin/index.js","mtime":1585735037898},{"path":"/Users/yangjikai/Documents/GitHub/theme/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yangjikai/Documents/GitHub/theme/node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yangjikai/Documents/GitHub/theme/node_modules/_eslint-loader@2.2.1@eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy95YW5namlrYWkvRG9jdW1lbnRzL0dpdEh1Yi90aGVtZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy95YW5namlrYWkvRG9jdW1lbnRzL0dpdEh1Yi90aGVtZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwoKLyoqCiAqIOS6i+S7tuaAu+e6vwogKiDln7rkuo4gcG9zdE1lc3NhZ2Ug6K6+6K6h77yM55uu55qE5piv6Kej5Yaz5aSaIHRhYiDkuYvpl7TpgJrkv6EKICovCnZhciBFdmVudEJ1cyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRXZlbnRCdXMoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRCdXMpOwoKICAgIC8vIOWIneWni+WMluiuoumYheS6i+S7tuWvueixoQogICAgdGhpcy5zdWJzY3JpYmVzID0ge307CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuaGFuZGxlck1ldGhvZC5iaW5kKHRoaXMpKTsKICB9CgogIF9jcmVhdGVDbGFzcyhFdmVudEJ1cywgW3sKICAgIGtleTogImhhbmRsZXJNZXRob2QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZXJNZXRob2QoZSkgewogICAgICB2YXIgZXZlbnQgPSBlLmtleSwKICAgICAgICAgIG5ld1ZhbHVlID0gZS5uZXdWYWx1ZTsgLy8gbG9jYWxTdG9yYWdlIOayoeWtl+aute+8jOaIluiAheayoeiuoumYheWwseebtOaOpei/lOWbngoKICAgICAgaWYgKCFsb2NhbFN0b3JhZ2UuZ2V0SXRlbShldmVudCkgfHwgIXRoaXMuc3Vic2NyaWJlc1tldmVudF0pIHJldHVybjsgLy8g5Yig6Zmk5Lmf5Lya6Kem5Y+RCgogICAgICBpZiAoIW5ld1ZhbHVlKSByZXR1cm47CiAgICAgIHZhciBkYXRhID0gbnVsbDsKCiAgICAgIHRyeSB7CiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UobmV3VmFsdWUpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGEgZXJyb3IgaW4gZGF0YSBwYXJzZScpOwogICAgICB9CgogICAgICB0aGlzLnN1YnNjcmliZXNbZXZlbnRdLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpdGVtICYmIGl0ZW0oZGF0YSk7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnN1YnNjcmliZXMsIDExMTExMTExMSk7CiAgICB9IC8vIOebkeWQrAoKICB9LCB7CiAgICBrZXk6ICJvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGNiKSB7CiAgICAgIHRoaXMuc3Vic2NyaWJlc1tldmVudF0gPSAodGhpcy5zdWJzY3JpYmVzW2V2ZW50XSB8fCBbXSkuY29uY2F0KGNiKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oZXZlbnQsICdpbml0Jyk7CiAgICB9IC8vIOebkeWQrOS4gOasoQoKICB9LCB7CiAgICBrZXk6ICJvbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbmNlKGV2ZW50LCBjYikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGZ1biA9IGZ1bmN0aW9uIGZ1bigpIHsKICAgICAgICBjYiAmJiBjYigpOwoKICAgICAgICBfdGhpcy5vZmYoZXZlbnQsIGZ1bik7CiAgICAgIH07CgogICAgICB0aGlzLm9uKGV2ZW50LCBmdW4pOwogICAgfSAvLyDliKDpmaQKCiAgfSwgewogICAga2V5OiAib2ZmIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgKHRoaXMuc3Vic2NyaWJlc1tldmVudF0gfHwgW10pLmZvckVhY2goZnVuY3Rpb24gKGNiLCBpKSB7CiAgICAgICAgaWYgKGNiID09PSBjYWxsYmFjaykgewogICAgICAgICAgX3RoaXMyLnN1YnNjcmliZXNbZXZlbnRdLnNwbGljZShpLCAxKTsKCiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShldmVudCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvZmZBbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9mZkFsbCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBPYmplY3Qua2V5cyh0aGlzLnN1YnNjcmliZXMpLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgZGVsZXRlIF90aGlzMy5zdWJzY3JpYmVzW2V2ZW50XTsKICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShldmVudCk7CiAgICAgIH0pOwogICAgfQogICAgLyogZXNsaW50LWRpc2FibGUgKi8KCiAgfSwgewogICAga2V5OiAiZW1pdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdChldmVudCwgcGF5bG9hZCkgewogICAgICAvLyDlpoLmnpzlj6rmmK/ljZXnuq/op6blj5HvvIzkuI3kvKDlj4LmlbDnmoTor53vvIznu5nkuKrpmo/mnLrmlbAKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oZXZlbnQsIHBheWxvYWQgPyBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSA6IE1hdGgucmFuZG9tKCkpOwogICAgfQogICAgLyogZXNsaW50LWVuYWJsZSAqLwoKICB9XSk7CgogIHJldHVybiBFdmVudEJ1czsKfSgpOwoKZXhwb3J0IGRlZmF1bHQgewogIGluc3RhbGw6IGZ1bmN0aW9uIGluc3RhbGwoVnVlKSB7CiAgICBWdWUucHJvdG90eXBlLiRldmVudEJ1cyA9IG5ldyBFdmVudEJ1cygpOwogIH0KfTs="},{"version":3,"sources":["/Users/yangjikai/Documents/GitHub/theme/src/plugin/index.js"],"names":["EventBus","subscribes","window","addEventListener","handlerMethod","bind","e","event","key","newValue","localStorage","getItem","data","JSON","parse","error","console","log","forEach","item","cb","concat","setItem","fun","off","on","callback","i","splice","removeItem","Object","keys","payload","stringify","Math","random","install","Vue","prototype","$eventBus"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;IAEMA,Q;AACF,sBAAc;AAAA;;AACV;AACA,SAAKC,UAAL,GAAkB,EAAlB;AACAC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmC,KAAKC,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAAnC;AACH;;;;kCAEaC,C,EAAG;AAAA,UACDC,KADC,GACkBD,CADlB,CACNE,GADM;AAAA,UACMC,QADN,GACkBH,CADlB,CACMG,QADN,EAGb;;AACA,UAAI,CAACC,YAAY,CAACC,OAAb,CAAqBJ,KAArB,CAAD,IAAgC,CAAC,KAAKN,UAAL,CAAgBM,KAAhB,CAArC,EAA6D,OAJhD,CAMb;;AACA,UAAI,CAACE,QAAL,EAAe;AAEf,UAAIG,IAAI,GAAG,IAAX;;AAEA,UAAI;AACAA,QAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWL,QAAX,CAAP;AACH,OAFD,CAEE,OAAOM,KAAP,EAAc;AACZC,QAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACH;;AAED,WAAKhB,UAAL,CAAgBM,KAAhB,EAAuBW,OAAvB,CAA+B,UAAAC,IAAI,EAAI;AAEnCA,QAAAA,IAAI,IAAIA,IAAI,CAACP,IAAD,CAAZ;AACH,OAHD;AAIAI,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKhB,UAAjB,EAA4B,SAA5B;AACH,K,CAED;;;;uBACGM,K,EAAOa,E,EAAI;AAEV,WAAKnB,UAAL,CAAgBM,KAAhB,IAAyB,CAAC,KAAKN,UAAL,CAAgBM,KAAhB,KAA0B,EAA3B,EAA+Bc,MAA/B,CAAsCD,EAAtC,CAAzB;AAEAV,MAAAA,YAAY,CAACY,OAAb,CAAqBf,KAArB,EAA4B,MAA5B;AAEH,K,CAED;;;;yBACKA,K,EAAOa,E,EAAI;AAAA;;AACZ,UAAMG,GAAG,GAAG,SAANA,GAAM,GAAM;AACdH,QAAAA,EAAE,IAAIA,EAAE,EAAR;;AACA,QAAA,KAAI,CAACI,GAAL,CAASjB,KAAT,EAAgBgB,GAAhB;AACH,OAHD;;AAIA,WAAKE,EAAL,CAAQlB,KAAR,EAAegB,GAAf;AACH,K,CAED;;;;wBACIhB,K,EAAOmB,Q,EAAU;AAAA;;AACjB,OAAC,KAAKzB,UAAL,CAAgBM,KAAhB,KAA0B,EAA3B,EAA+BW,OAA/B,CAAuC,UAACE,EAAD,EAAKO,CAAL,EAAW;AAC9C,YAAIP,EAAE,KAAKM,QAAX,EAAqB;AACjB,UAAA,MAAI,CAACzB,UAAL,CAAgBM,KAAhB,EAAuBqB,MAAvB,CAA8BD,CAA9B,EAAiC,CAAjC;;AACAjB,UAAAA,YAAY,CAACmB,UAAb,CAAwBtB,KAAxB;AACH;AACJ,OALD;AAMH;;;6BAEQ;AAAA;;AACLuB,MAAAA,MAAM,CAACC,IAAP,CAAY,KAAK9B,UAAjB,EAA6BiB,OAA7B,CAAqC,UAAAX,KAAK,EAAI;AAC1C,eAAO,MAAI,CAACN,UAAL,CAAgBM,KAAhB,CAAP;AACAG,QAAAA,YAAY,CAACmB,UAAb,CAAwBtB,KAAxB;AACH,OAHD;AAIH;AAED;;;;yBACKA,K,EAAOyB,O,EAAS;AACjB;AACAtB,MAAAA,YAAY,CAACY,OAAb,CAAqBf,KAArB,EAA4ByB,OAAO,GAAGnB,IAAI,CAACoB,SAAL,CAAeD,OAAf,CAAH,GAA6BE,IAAI,CAACC,MAAL,EAAhE;AACH;AACD;;;;;;;AAGJ,eAAe;AACXC,EAAAA,OADW,mBACHC,GADG,EACE;AACTA,IAAAA,GAAG,CAACC,SAAJ,CAAcC,SAAd,GAA0B,IAAIvC,QAAJ,EAA1B;AACH;AAHU,CAAf","sourcesContent":["/**\n * 事件总线\n * 基于 postMessage 设计，目的是解决多 tab 之间通信\n */\n\nclass EventBus {\n    constructor() {\n        // 初始化订阅事件对象\n        this.subscribes = {};\n        window.addEventListener('storage', this.handlerMethod.bind(this));\n    }\n\n    handlerMethod(e) {\n        const {key: event, newValue} = e;\n\n        // localStorage 没字段，或者没订阅就直接返回\n        if (!localStorage.getItem(event) || !this.subscribes[event]) return;\n\n        // 删除也会触发\n        if (!newValue) return;\n\n        let data = null;\n\n        try {\n            data = JSON.parse(newValue);\n        } catch (error) {\n            console.log('this is a error in data parse');\n        }\n\n        this.subscribes[event].forEach(item => {\n\n            item && item(data);\n        });\n        console.log(this.subscribes,111111111)\n    }\n\n    // 监听\n    on(event, cb) {\n\n        this.subscribes[event] = (this.subscribes[event] || []).concat(cb);\n\n        localStorage.setItem(event, 'init');\n\n    }\n\n    // 监听一次\n    once(event, cb) {\n        const fun = () => {\n            cb && cb();\n            this.off(event, fun);\n        };\n        this.on(event, fun);\n    }\n\n    // 删除\n    off(event, callback) {\n        (this.subscribes[event] || []).forEach((cb, i) => {\n            if (cb === callback) {\n                this.subscribes[event].splice(i, 1);\n                localStorage.removeItem(event);\n            }\n        });\n    }\n\n    offAll() {\n        Object.keys(this.subscribes).forEach(event => {\n            delete this.subscribes[event];\n            localStorage.removeItem(event);\n        });\n    }\n\n    /* eslint-disable */\n    emit(event, payload) {\n        // 如果只是单纯触发，不传参数的话，给个随机数\n        localStorage.setItem(event, payload ? JSON.stringify(payload) : Math.random());\n    }\n    /* eslint-enable */\n}\n\nexport default {\n    install(Vue) {\n        Vue.prototype.$eventBus = new EventBus();\n    },\n};\n\n"]}]}